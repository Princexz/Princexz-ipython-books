<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="IPython Cookbook, ">


    <!-- FAVICON -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">


        <link rel="alternate"  href="https://ipython-books.github.io/feeds/all.atom.xml" type="application/atom+xml" title="IPython Cookbook Full Atom Feed"/>

        <title>IPython Cookbook - 1.2. Getting started with exploratory data analysis in the Jupyter Notebook</title>

    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" href="https://ipython-books.github.io/theme/css/styles.css">
    <link rel="stylesheet" href="https://ipython-books.github.io/theme/css/pygments.css">
    <!-- <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'> -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,500" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
</head>

<body>


    <header id="header" class="pure-g">
        <div class="pure-u-1 pure-u-md-3-4">
             <div id="menu">
                 <div class="pure-menu pure-menu-open pure-menu-horizontal">
<ul>
        <li><a href="/">home</a></li>
        <li><a href="https://github.com/ipython-books/cookbook-2nd-code">Jupyter notebooks</a></li>
        <li><a href="https://github.com/ipython-books/minibook-2nd-code">minibook</a></li>
        <li><a href="https://cyrille.rossant.net">author</a></li>
</ul>                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-4">
            <div id="social">
                <div class="pure-menu pure-menu-open pure-menu-horizontal">
<ul>
        <li><a href="https://twitter.com/cyrillerossant"><i class="fa fa-twitter"></i></a></li>
        <li><a href="https://github.com/ipython-books/cookbook-2nd"><i class="fa fa-github"></i></a></li>
</ul>                </div>
            </div>
        </div>
    </header>
       

    
    <div id="layout" class="pure-g">
        <section id="content" class="pure-u-1 pure-u-md-4-4">
            <div class="l-box">

    <header id="page-header">
        <h1>1.2. Getting started with exploratory data analysis in the Jupyter Notebook</h1>
    </header>

    <section id="page">
        <p><a href="/"><img src="https://raw.githubusercontent.com/ipython-books/cookbook-2nd/master/cover-cookbook-2nd.png" align="left" alt="IPython Cookbook, Second Edition" height="130" style="margin-right: 20px; margin-bottom: 10px;" /></a> <em>This is one of the 100+ free recipes of the <a href="/">IPython Cookbook, Second Edition</a>, by <a href="http://cyrille.rossant.net">Cyrille Rossant</a>, a guide to numerical computing and data science in the Jupyter Notebook. The ebook and printed book are available for purchase at <a href="https://www.packtpub.com/big-data-and-business-intelligence/ipython-interactive-computing-and-visualization-cookbook-second-e">Packt Publishing</a>.</em></p>
<p>▶&nbsp;&nbsp;<em><a href="https://github.com/ipython-books/cookbook-2nd">Text on GitHub</a> with a <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/us/legalcode">CC-BY-NC-ND license</a></em><br />
▶&nbsp;&nbsp;<em><a href="https://github.com/ipython-books/cookbook-2nd-code">Code on GitHub</a> with a <a href="https://opensource.org/licenses/MIT">MIT license</a></em></p>
<p>▶&nbsp;&nbsp;<a href="https://ipython-books.github.io/chapter-1-a-tour-of-interactive-computing-with-jupyter-and-ipython/"><strong><em>Go to</em></strong> <em>Chapter 1 : A Tour of Interactive Computing with Jupyter and IPython</em></a><br />
▶&nbsp;&nbsp;<a href="https://github.com/ipython-books/cookbook-2nd-code/blob/master/chapter01_basic/02_pandas.ipynb"><em><strong>Get</strong> the Jupyter notebook</em></a>  </p>
<p>In this recipe, we will give an introduction to IPython and Jupyter for data analysis. Most of the subject has been covered in the the prequel of this book, <em>Learning IPython for Interactive Computing and Data Visualization, Second Edition</em>, but we will review the basics here.</p>
<p>We will download and analyze a dataset about attendance on Montreal's bicycle tracks. This example is largely inspired by a presentation from Julia Evans (available at <a href="https://github.com/jvns/talks/blob/master/2013-04-mtlpy/pistes-cyclables.ipynb">https://github.com/jvns/talks/blob/master/2013-04-mtlpy/pistes-cyclables.ipynb</a>). Specifically, we will introduce the following:</p>
<ul>
<li>Data manipulation with pandas</li>
<li>Data visualization with matplotlib</li>
<li>Interactive widgets</li>
</ul>
<h2>How to do it...</h2>
<p><strong>1.&nbsp;</strong> The very first step is to import the scientific packages we will be using in this recipe, namely NumPy, pandas, and matplotlib. We also instruct matplotlib to render the figures as inline images in the Notebook:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>


<blockquote>
<p>We can enable high-resolution matplotlib figures on Retina display systems with the following commands:</p>
<p><code>python
from IPython.display import set_matplotlib_formats
set_matplotlib_formats('retina')</code></p>
</blockquote>
<p><strong>2.&nbsp;</strong> Now, we create a new Python variable called <code>url</code> that contains the address to a <strong>CSV (Comma-separated values)</strong> data file. This standard text-based file format is used to store tabular data:</p>
<div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/&quot;</span>
       <span class="s2">&quot;ipython-books/cookbook-2nd-data/&quot;</span>
       <span class="s2">&quot;master/bikes.csv&quot;</span><span class="p">)</span>
</pre></div>


<p><strong>3.&nbsp;</strong> pandas defines a <code>read_csv()</code> function that can read any CSV file. Here, we pass the URL to the file. pandas will automatically download the file, parse it, and return a <code>DataFrame</code> object. We need to specify a few options to make sure that the dates are parsed correctly:</p>
<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>
                 <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p><strong>4.&nbsp;</strong> The <code>df</code> variable contains a <strong>DataFrame</strong> object, a specific pandas data structure that contains 2D tabular data. The <code>head(n)</code> method displays the first <code>n</code> rows of this table. In the Notebook, pandas displays a <code>DataFrame</code> object in an HTML table, as shown in the following screenshot:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<p><img alt="Output" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_13_0.png" /></p>
<p>Here, every row contains the number of bicycles on every track of the city, for every day of the year.</p>
<p><strong>5.&nbsp;</strong> We can get some summary statistics of the table with the <code>describe()</code> method:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>


<p><img alt="Output" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_16_0.png" /></p>
<p><strong>6.&nbsp;</strong> Let's display some figures. We will plot the daily attendance of two tracks. First, we select the two columns, <code>Berri1</code> and <code>PierDup</code>. Then, we call the <code>plot()</code> method:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Berri1&#39;</span><span class="p">,</span> <span class="s1">&#39;PierDup&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                               <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">],</span>
                               <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<p><img alt="&lt;matplotlib.figure.Figure at 0x7fe6b43abc18&gt;" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_18_0.png" /></p>
<p><strong>7.&nbsp;</strong> Now, we move to a slightly more advanced analysis. We will look at the attendance of all tracks as a function of the weekday. We can get the weekday easily with pandas: the <code>index</code> attribute of the <code>DataFrame</code> object contains the dates of all rows in the table. This index has a few date-related attributes, including <code>weekday_name</code>:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">weekday_name</span>
</pre></div>


<div class="highlight"><pre><span></span>Index([&#39;Tuesday&#39;, &#39;Wednesday&#39;, &#39;Thursday&#39;, &#39;Friday&#39;,
       &#39;Saturday&#39;, &#39;Sunday&#39;, &#39;Monday&#39;, &#39;Tuesday&#39;,
       ...
       &#39;Friday&#39;, &#39;Saturday&#39;, &#39;Sunday&#39;, &#39;Monday&#39;,
       &#39;Tuesday&#39;, &#39;Wednesday&#39;],
      dtype=&#39;object&#39;, name=&#39;Date&#39;, length=261)
</pre></div>


<p><strong>8.&nbsp;</strong> To get the attendance as a function of the weekday, we need to group the table elements by the weekday. The <code>groupby()</code> method lets us do just that. We use <code>weekday</code> instead of <code>weekday_name</code> to keep the weekday order (Monday is 0, Tuesday is 1, and so on). Once grouped, we can sum all rows in every group:</p>
<div class="highlight"><pre><span></span><span class="n">df_week</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">weekday</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_week</span>
</pre></div>


<p><img alt="Output" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_23_0.png" /></p>
<p><strong>9.&nbsp;</strong> We can now display this information in a figure. We create a matplotlib figure, and we use the <code>plot()</code> method of a <code>DataFrame</code> to create our plot:</p>
<div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">df_week</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Weekday&#39;</span><span class="p">)</span>
<span class="c1"># We replace the labels 0, 1, 2... by the weekday</span>
<span class="c1"># names.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;Monday,Tuesday,Wednesday,Thursday,&#39;</span>
     <span class="s1">&#39;Friday,Saturday,Sunday&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Set the bottom axis to 0.</span>
</pre></div>


<p><img alt="&lt;matplotlib.figure.Figure at 0x8f03e48&gt;" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_25_0.png" /></p>
<p><strong>10.&nbsp;</strong> Finally, let's illustrate the interactive capabilities of the Notebook. We will plot a <em>smoothed</em> version of the track attendance as a function of time (<strong>rolling mean</strong>). The idea is to compute the mean value in the neighborhood of any day. The larger the neighborhood, the smoother the curve. We will create an interactive slider in the Notebook to vary this parameter in real time in the plot. All we have to do is add the <code>@interact</code> decorator above our plotting function:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>

<span class="nd">@interact</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Berri1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7000</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="Rolling mean" src="https://ipython-books.github.io/pages/chapter01_basic/02_pandas_files/02_pandas_27_0.png" /></p>
<h2>How it works...</h2>
<p>To create matplotlib figures, it is good practice to create a Figure (<code>fig</code>) and one or several Axes (subplots, <code>ax</code> object) with the <code>plt.subplots()</code> command. The <code>figsize</code> keyword argument lets us specify the size of the figure, in inches. Then, we call plotting methods directly on the Axes instances. Here, for example, we set the y limits of the axis with the <code>set_ylim()</code> method. If there are existing plotting commands, like the <code>plot()</code> method provided by pandas on DataFrame instances, we can pass the relevant Axis instance with the <code>ax</code> keyword argument.</p>
<h2>There's more...</h2>
<p>pandas is the main data wrangling library in Python. Other tools and methods are generally required for more advanced analyses (signal processing, statistics, and mathematical modeling). We will cover these steps in the second part of this book, starting with <em>Chapter 7, Statistical Data Analysis</em>.</p>
<p>Here are some more references about data manipulation with pandas:</p>
<ul>
<li><em>Learning IPython for Interactive Computing and Data Visualization Second Edition, Packt Publishing</em>, the prequel of this book</li>
<li><em>Python for Data Analysis</em>, O'Reilly Media, by Wes McKinney, the creator of pandas, at <a href="http://shop.oreilly.com/product/0636920023784.do">http://shop.oreilly.com/product/0636920023784.do</a></li>
<li><em>Python Data Science Handbook</em>, O'Reilly Media, by Jake VanderPlas, at <a href="http://shop.oreilly.com/product/0636920034919.do">http://shop.oreilly.com/product/0636920034919.do</a></li>
<li>The documentation of pandas available at <a href="http://pandas.pydata.org/pandas-docs/stable/">http://pandas.pydata.org/pandas-docs/stable/</a></li>
<li>Usage guide of matplotlib, at <a href="https://matplotlib.org/tutorials/introductory/usage.html">https://matplotlib.org/tutorials/introductory/usage.html</a></li>
</ul>
<h2>See also</h2>
<ul>
<li>Introducing the multidimensional array in NumPy for fast array computations</li>
</ul>
    </section>

            </div>
        </section>

        <footer id="footer" class="pure-u-1 pure-u-md-4-4">
            <div class="l-box">
                <div>
                    <p>&copy; <a href="https://cyrille.rossant.net">Cyrille Rossant</a> &ndash;
                        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
                        for <a href="https://blog.getpelican.com/">Pelican</a>
                    </p>
                </div>
            </div>
        </footer>
        
    </div>
    
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9752080; 
var sc_invisible=1; 
var sc_security="c177b501"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/9752080/0/c177b501/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>